---
import { getConfig, getVersionedDocsPath } from '../../libs/config'
import type { Layout } from '../../libs/layout'
import Stylesheet from './Stylesheet.astro'
import Favicons from './Favicons.astro'
import Social from './Social.astro'
import Analytics from './Analytics.astro'

interface Props {
  description: string
  direction?: 'rtl'
  layout: Layout
  robots: string | undefined
  thumbnail: string
  title: string
}

const { description, direction, layout, robots, thumbnail, title } = Astro.props

const canonicalUrl = new URL(Astro.url.pathname, Astro.site)

const isHome = Astro.url.pathname === '/'
const pageTitle = isHome
  ? `${getConfig().title} · ${getConfig().subtitle}`
  : `${title} · ${getConfig().title} v${getConfig().docs_version}`
---

<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="description" content={description} />
<!--TODO: handle | markdownify -->
<!-- TODO(HiDeoo) markdownify in a meta tag? -->

<meta name="author" content={getConfig().authors} />
<meta name="generator" content={Astro.generator} />
<meta name="docsearch:language" content="en" />
<meta name="docsearch:version" content={getConfig().docs_version} />

<title>{pageTitle}</title>

<link rel="canonical" href={canonicalUrl} />

{layout === 'docs' && <link rel="preconnect" href="https://AK7KMZKZHQ-dsn.algolia.net" crossorigin />}
{robots && <meta name="robots" content={robots} />}

<script is:inline src={getVersionedDocsPath('assets/js/color-modes.js')}></script>

<Stylesheet direction={direction} layout={layout} />
<Favicons />
<Social description={description} thumbnail={thumbnail} title={title} />
<Analytics />
